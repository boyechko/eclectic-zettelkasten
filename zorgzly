#!/bin/bash
# Fix the timestamps and commit with default commit string

if [[ -z "$ZETTEL_DIR" ]]; then
    echo "$(basename $0): $ZETTEL_DIR is not set"
    exit 1
fi

#work=20190228T1454.txt
journal=20180727T1421.txt
todo=20190514T1925.txt

cd $HOME/Dropbox/Apps/Orgzly
if [[ $1 == "push" ]]; then
    # Copy files to ~/Dropbox/Apps/Orgzly
    echo -n "Pushing files to Apps/Orgzly..."
#    cp $ZETTEL_DIR/limbo/$work work.org
    cp $ZETTEL_DIR/limbo/$journal journal.org
    cp $ZETTEL_DIR/limbo/$todo todo.org
    echo "Done"
else
    # Copy files from ~/Dropbox/Apps/Orgzly
    echo -n "Pulling files from Apps/Orgzly..."
    modified=$(date "+%Y-%m-%d")
#    sed -e "s/^modified:.*$/modified: ${modified}/" work.org > $ZETTEL_DIR/limbo/$work
    sed -e "s/^modified:.*$/modified: ${modified}/" journal.org > $ZETTEL_DIR/limbo/$journal
    sed -e "s/^modified:.*$/modified: ${modified}/" todo.org > $ZETTEL_DIR/limbo/$todo
    echo "Done"
fi
