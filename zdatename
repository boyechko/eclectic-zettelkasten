#!/usr/bin/bash
# Outputs the date name (YYYYMMDDThhmm) for the given file

fname=$1
ext=${fname#*.}

created=`grep '^created:' $fname`
if [[ $created =~ created:.+([0-9]{4})-([0-9]{2})-([0-9]{2}) ]]; then
    year=${BASH_REMATCH[1]}
    month=${BASH_REMATCH[2]}
    day=${BASH_REMATCH[3]}

    modified=`stat $fname | grep '^Modify:'`
    if [[ $modified =~ Modify:.*([0-9]{2}):([0-9]{2}):[0-9]{2}\.[0-9]{9} ]]; then
        hour=${BASH_REMATCH[1]}
        minute=${BASH_REMATCH[2]}

        echo "${year}${month}${day}T${hour}${minute}.$ext"
    else
        echo "No modification time"
        exit 1
    fi
else
    echo "No created date"
    exit 1
fi
    
